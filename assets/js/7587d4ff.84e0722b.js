"use strict";(self.webpackChunk_meridian_cfi_specviz_website=self.webpackChunk_meridian_cfi_specviz_website||[]).push([[584],{7527:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>x,contentTitle:()=>l,default:()=>p,frontMatter:()=>u,metadata:()=>d,toc:()=>h});var r=n(1085),o=n(1184),s=n(3550),i=n(4041);function a(e){const t=i.useMemo((()=>({seconds:s._0.time(0,e.duration),hertz:s._0.frequency(2e4,0)})),[e.duration]);return(0,r.jsx)(s._0.Provider,{value:t,children:(0,r.jsx)("div",{style:{backgroundColor:"cornsilk",border:"1px solid burlywood",display:"grid",gridGap:"1rem",gridTemplateColumns:"80px 1fr",gridTemplateRows:"400px 20px",gridTemplateAreas:'\n            "y viz"\n            ". x"\n          ',margin:"1.5rem 0",padding:"1rem"},children:(0,r.jsxs)(s.Zc.K,{xaxis:"seconds",yaxis:"hertz",children:[(0,r.jsx)("div",{style:{gridArea:"x"},children:(0,r.jsx)(s._0.Horizontal,{})}),(0,r.jsx)("div",{style:{gridArea:"y"},children:(0,r.jsx)(s._0.Vertical,{})}),(0,r.jsx)("div",{style:{gridArea:"viz"},children:(0,r.jsx)(s.Di,{src:e.spectrogram})})]})})})}var c=n(9359);const u={sidebar_position:1,tags:["axis","plane"]},l="Basic Spectrogram",d={id:"examples/basic-spectrogram",title:"Basic Spectrogram",description:"Render an image and axes.",source:"@site/docs/examples/basic-spectrogram.mdx",sourceDirName:"examples",slug:"/examples/basic-spectrogram",permalink:"/specviz/docs/examples/basic-spectrogram",draft:!1,unlisted:!1,tags:[{inline:!0,label:"axis",permalink:"/specviz/docs/tags/axis"},{inline:!0,label:"plane",permalink:"/specviz/docs/tags/plane"}],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,tags:["axis","plane"]},sidebar:"mainSidebar",previous:{title:"Examples",permalink:"/specviz/docs/category/examples"},next:{title:"Basic Audio",permalink:"/specviz/docs/examples/basic-audio"}},x={},h=[{value:"Define Axes",id:"define-axes",level:3},{value:"Axis Functions",id:"axis-functions",level:3},{value:"Define Plane",id:"define-plane",level:3}];function f(e){const t={code:"code",div:"div",h1:"h1",h3:"h3",header:"header",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"basic-spectrogram",children:"Basic Spectrogram"})}),"\n",(0,r.jsx)(t.p,{children:"Render an image and axes."}),"\n","\n",(0,r.jsx)(c.A,{fallback:(0,r.jsx)(t.div,{children:"Loading..."}),children:e=>(0,r.jsx)(a,{spectrogram:e("/spectrogram.png"),duration:44.346})}),"\n",(0,r.jsx)(t.h3,{id:"define-axes",children:"Define Axes"}),"\n",(0,r.jsxs)(t.p,{children:["In your application provider, use ",(0,r.jsx)(t.code,{children:"Specviz.Axis.Provider"})," to provide the axes."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-tsx",metastring:'title="./App.jsx"',children:'import * as Specviz from "@meridian_cfi/specviz"\n\nfunction AppProvider(props) {\n  const axes = React.useMemo(\n    () => ({\n      seconds: ...\n      hertz: ...\n      decibels: ...\n      myaxis: ...\n    }),\n    [],\n  )\n  return (\n    <Specviz.Axis.Provider value={axes}>\n      <...>\n        {props.children}\n      </...>\n    </Specviz.Axis.Provider>\n  )\n}\n'})}),"\n",(0,r.jsx)(t.h3,{id:"axis-functions",children:"Axis Functions"}),"\n",(0,r.jsxs)(t.p,{children:["To create the axes, ",(0,r.jsx)(t.code,{children:"Axis.time"})," and ",(0,r.jsx)(t.code,{children:"Axis.frequency"})," are\nused. To create a custom axis, use ",(0,r.jsx)(t.code,{children:"Axis.linear"})," and ",(0,r.jsx)(t.code,{children:"Axis.nonlinear"}),"."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-tsx",metastring:'title="./App.jsx"',children:"function AppProvider(props) {\n  const axes = React.useMemo(\n    () => ({\n      seconds: Specviz.Axis.time(0, 60),\n      hertz: Specviz.Axis.frequency(20000, 0),\n    }),\n    [],\n  )\n  return ...\n}\n"})}),"\n",(0,r.jsx)(t.h3,{id:"define-plane",children:"Define Plane"}),"\n",(0,r.jsxs)(t.p,{children:["Finally, use the ",(0,r.jsx)(t.code,{children:"Specviz.Plane.Provider"})," to designate particular axes to the\nvisualization."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-tsx",metastring:'title="./App.jsx"',children:'function App() {\n  return (\n    <Specviz.Plane.Provider xaxis="seconds" yaxis="hertz">\n      <div>\n        <Specviz.Axis.Horizontal />\n      </div>\n      <div>\n        <Specviz.Axis.Vertical />\n      </div>\n      <div>\n        <Specviz.Visualization src="./spectrogram.png" />\n      </div>\n    </Specviz.Plane.Provider>\n  )\n}\n'})})]})}function p(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(f,{...e})}):f(e)}},4760:(e,t,n)=>{function r(e){return e<1e3?e.toFixed(0)+" Hz":(e/1e3).toFixed(3)+" kHz"}function o(e){return(100*e).toFixed(3)+"%"}function s(e){const t=Math.floor(e/60);return`${t}:${(e-t).toFixed(3).padStart(2,"0")}`}function i(e){const t=new Uint8Array(e);return window.crypto.getRandomValues(t),Array.from(t,(e=>e.toString(16).padStart(2,"0"))).join("")}n.d(t,{KN:()=>o,hz:()=>r,po:()=>i,vE:()=>s})},3550:(e,t,n)=>{n.d(t,{rc:()=>r,fP:()=>u,_0:()=>a,jW:()=>ke,Nz:()=>ve,pd:()=>o,DA:()=>Se,mD:()=>Fe,L7:()=>c,Zc:()=>s,LM:()=>i,Di:()=>Le});var r={};n.r(r),n.d(r,{K:()=>f,N:()=>p});var o={};n.r(o),n.d(o,{K:()=>k,N:()=>S});var s={};n.r(s),n.d(s,{K:()=>z,N:()=>A});var i={};n.r(i),n.d(i,{Provider:()=>D,Transform:()=>U,ZoomDirection:()=>N,useContext:()=>I});var a={};n.r(a),n.d(a,{Horizontal:()=>ee,Provider:()=>oe,Vertical:()=>te,computeRect:()=>X,computeRectInverse:()=>G,computeUnit:()=>Y,computeUnitInverse:()=>V,formatUnit:()=>H,frequency:()=>Q,linear:()=>W,nonlinear:()=>Z,percent:()=>J,time:()=>O,useContext:()=>se});var c={};n.r(c),n.d(c,{Annotation:()=>pe,Provider:()=>le,SelectionMode:()=>ie,Transform:()=>fe,computeRectInverse:()=>xe,selectionMode:()=>he,useContext:()=>de});var u={};n.r(u),n.d(u,{Effect:()=>Ne,Provider:()=>ze,Seek:()=>Ee,TransformFx:()=>Re,load:()=>Me,useContext:()=>Ae});var l=n(4041),d=n(1085);const x={},h=l.createContext(x);function f(e){const t=l.useContext(h),n=l.useMemo((()=>({...t,...e})),[t,e]);return(0,d.jsx)(h.Provider,{children:e.children,value:n})}function p(){return l.useContext(h)}var m=n(4760);function y(e,t,n,r){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=0);let o=e,s=t,i=n,a=r;return{abs:{get x(){return o},set x(e){o=e},get y(){return s},set y(e){s=e}},rel:{get x(){return i},set x(e){i=e},get y(){return a},set y(e){a=e}}}}const g={x:0,y:0};function v(e,t){void 0===e&&(e=0),void 0===t&&(t=0);let n=e,r=t;return{get x(){return n},get y(){return r},set x(e){n=e},set y(e){r=e}}}const w={input:{alt:!1,buttons:0,focus:null,xaxis:null,yaxis:null},mousedown:{abs:g,rel:g},mouseup:{abs:g,rel:g},unitDown:g,unitUp:g},b=l.createContext(w);function k(e){const t=l.useMemo((()=>{let e=0,t=!1,n=null,r=null,o=null;return{get buttons(){return e},set buttons(t){e=t},get alt(){return t},set alt(e){t=e},get focus(){return n},set focus(e){n=e},get xaxis(){return r},set xaxis(e){r=e},get yaxis(){return o},set yaxis(e){o=e}}}),[]),n=l.useMemo(y,[]),r=l.useMemo(y,[]),o=l.useMemo(v,[]),s=l.useMemo(v,[]),i={input:t,mousedown:n,mouseup:r,unitDown:o,unitUp:s};return l.useEffect((()=>{function e(e){"Alt"==e.key&&(t.alt=!0)}function n(e){"Alt"==e.key&&(t.alt=!1)}return window.addEventListener("keydown",e),window.addEventListener("keyup",n),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",n)}}),[t]),(0,d.jsx)(b.Provider,{children:e.children,value:i})}function S(){return l.useContext(b)}function M(e,t,n){return Math.min(Math.max(e,t),n)}const j={xaxis:W(0,100,"x"),yaxis:W(0,100,"y")},C=l.createContext(j);function z(e){const t=se(),n=t[e.xaxis],r=t[e.yaxis];if(null==n)throw Error(`axis not found: ${e.xaxis}`);if(null==r)throw Error(`axis not found: ${e.yaxis}`);return(0,d.jsx)(C.Provider,{children:e.children,value:{xaxis:n,yaxis:r}})}function A(){return l.useContext(C)}function R(e,t){return{x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),width:Math.abs(t.x-e.x),height:Math.abs(t.y-e.y)}}function E(e,t,n){return{x:t?e.x:0,y:n?e.y:0,width:t?e.width:1,height:n?e.height:1}}let N=function(e){return e[e.out=0]="out",e[e.in=1]="in",e}({});const P={state:{scroll:{x:0,y:0},zoom:{x:1,y:1}},resetView:()=>{throw Error("resetView called outside of context")},scroll:()=>{throw Error("scroll called outside of context")},scrollTo:()=>{throw Error("scrollTo called outside of context")},zoom:()=>{throw Error("zoom called outside of context")},zoomArea:()=>{throw Error("zoomArea called outside of context")},zoomPoint:()=>{throw Error("zoomPoint called outside of context")},zoomScroll:()=>{throw Error("zoomScroll called outside of context")}},T={x:10,y:10},$=l.createContext(P);function D(e){const t=S(),[n,r]=l.useState(P.state),o=l.useCallback((()=>{r(P.state)}),[]),s=l.useCallback(((e,t)=>{r((n=>({...n,scroll:{x:M(n.scroll.x+e,0,n.zoom.x-1),y:M(n.scroll.y+t,0,n.zoom.y-1)}})))}),[]),i=l.useCallback((e=>{r((t=>({...t,scroll:{x:M(e.x,0,t.zoom.x-1),y:M(e.y,0,t.zoom.y-1)}})))}),[]),a=l.useCallback(((e,t)=>{r((n=>({...n,zoom:{x:M(n.zoom.x+e,1,T.x),y:M(n.zoom.y+t,1,T.y)}})))}),[]),c=l.useCallback((e=>{r((t=>{const n=M(1/e.width,1,T.x),r=M(1/e.height,1,T.y);return{zoom:{x:n,y:r},scroll:{x:M((e.x+e.width/2)*n-.5,0,n-1),y:M((e.y+e.height/2)*r-.5,0,r-1)}}}))}),[]),u=l.useCallback(((e,t)=>{r((n=>{const r=t==N.out?-.5:.5,o=e.x*n.zoom.x-n.scroll.x,s=e.y*n.zoom.y-n.scroll.y,i=M(n.zoom.x+r,1,T.x),a=M(n.zoom.y+r,1,T.y);return{zoom:{x:i,y:a},scroll:{x:M(e.x*i-o,0,i-1),y:M(e.y*a-s,0,a-1)}}}))}),[]),x=l.useCallback(((e,n)=>{r((r=>{const o=M(r.zoom.x+e,1,T.x),s=M(r.zoom.y+n,1,T.y);return{zoom:{x:o,y:s},scroll:{x:M(t.mousedown.abs.x*o-t.mousedown.rel.x,0,o-1),y:M(t.mousedown.abs.y*s-t.mousedown.rel.y,0,s-1)}}}))}),[t.mousedown.abs,t.mousedown.rel]),h=l.useMemo((()=>({resetView:o,scroll:s,scrollTo:i,state:n,zoom:a,zoomArea:c,zoomPoint:u,zoomScroll:x})),[o,s,i,n,a,c,u,x]);return(0,d.jsx)($.Provider,{children:e.children,value:h})}function I(){return l.useContext($)}function U(e){const t=I(),n=l.useMemo((()=>{const n=e.fn(t.state);return{...t,state:n}}),[t,e.fn]);return(0,d.jsx)($.Provider,{children:e.children,value:n})}function F(e){l.useEffect((()=>{let t;return t=window.requestAnimationFrame((function n(r){e(r),t=window.requestAnimationFrame(n)})),()=>{window.cancelAnimationFrame(t)}}),[e])}function K(e){const t=S(),n=A();return function(e){const t=A(),n=S(),r=I(),o=l.useCallback((t=>{t.preventDefault(),e.onContextMenu?.(t)}),[e.onContextMenu]),s=l.useCallback((t=>{t.preventDefault(),n.input.buttons=t.buttons,e.onMouseDown?.(t)}),[n.input,e.onMouseDown]),i=l.useCallback((o=>{const s=o.currentTarget.getBoundingClientRect(),i=(o.clientX-s.x)/s.width,a=(o.clientY-s.y)/s.height;1&n.input.buttons?(n.mouseup.rel.x=i,n.mouseup.rel.y=a,n.mouseup.abs.x=(i+r.state.scroll.x)/r.state.zoom.x,n.mouseup.abs.y=(a+r.state.scroll.y)/r.state.zoom.y,n.unitUp.x=Y(t.xaxis,M(n.mouseup.abs.x,0,1)),n.unitUp.y=Y(t.yaxis,M(n.mouseup.abs.y,0,1))):(n.mousedown.rel.x=n.mouseup.rel.x=i,n.mousedown.rel.y=n.mouseup.rel.y=a,n.mousedown.abs.x=n.mouseup.abs.x=(i+r.state.scroll.x)/r.state.zoom.x,n.mousedown.abs.y=n.mouseup.abs.y=(a+r.state.scroll.y)/r.state.zoom.y,n.unitDown.x=n.unitUp.x=Y(t.xaxis,M(n.mousedown.abs.x,0,1)),n.unitDown.y=n.unitUp.y=Y(t.yaxis,M(n.mousedown.abs.y,0,1))),e.onMouseMove?.(o)}),[n.input,n.mousedown,n.mouseup,t.xaxis,t.yaxis,e.onMouseMove,n.unitDown,n.unitUp,r.state.scroll.x,r.state.scroll.y,r.state.zoom.x,r.state.zoom.y]),a=l.useCallback((t=>{e.onMouseUp?.(t),n.input.buttons=0}),[n.input,e.onMouseUp]),c=l.useCallback((r=>{n.input.focus=r.currentTarget,null!=t.xaxis&&(n.input.xaxis=t.xaxis),null!=t.yaxis&&(n.input.yaxis=t.yaxis),e.onMouseEnter?.(r)}),[n.input,t.xaxis,t.yaxis,e.onMouseEnter]),u=l.useCallback((t=>{e.onMouseLeave?.(t),n.input.buttons=0,n.input.focus=null,n.input.xaxis=null,n.input.yaxis=null}),[n.input,e.onMouseLeave]);return l.useMemo((()=>({onContextMenu:o,onMouseDown:s,onMouseMove:i,onMouseUp:a,onMouseEnter:c,onMouseLeave:u})),[o,s,i,a,c,u])}({onMouseMove:l.useCallback((n=>{if(1&t.input.buttons){const t=n.movementX/n.currentTarget.clientWidth,r=n.movementY/n.currentTarget.clientHeight;e.onDrag?.({dx:t,dy:r,event:n})}}),[t.input,e.onDrag]),onMouseUp:l.useCallback((r=>{if(1&t.input.buttons){const s=R(t.mousedown.abs,t.mouseup.abs);o=s,Math.sqrt(o.width**2+o.height**2)<.01?e.onClick?.({event:r,unit:t.unitUp,rel:t.mouseup.rel,abs:t.mouseup.abs,xaxis:n.xaxis,yaxis:n.yaxis}):e.onRect?.({event:r,unit:R(t.unitDown,t.unitUp),rel:R(t.mousedown.rel,t.mouseup.rel),abs:s,xaxis:n.xaxis,yaxis:n.yaxis})}else 2&t.input.buttons&&e.onContextMenu?.({event:r,unit:t.unitUp,rel:t.mouseup.rel,abs:t.mouseup.abs,xaxis:n.xaxis,yaxis:n.yaxis});var o}),[t.input,t.mousedown,t.mouseup,t.unitDown,t.unitUp,n.xaxis,n.yaxis,e.onClick,e.onContextMenu,e.onRect])})}function L(e){const[t,n]=l.useState(g),r=l.useMemo((()=>new ResizeObserver((e=>{for(const t of e)for(const{blockSize:e,inlineSize:r}of t.borderBoxSize)n((t=>t.x===r&&t.y===e?t:{x:r,y:e}))}))),[]);return l.useLayoutEffect((()=>(e.current&&r.observe(e.current),()=>{r.disconnect()})),[r,e]),t}function _(e,t){const n=l.useCallback((n=>{if(e.current){n.preventDefault();const r=n.deltaX/e.current.clientWidth,o=n.deltaY/e.current.clientHeight;t?.({dx:r,dy:o,event:n})}}),[t,e]);l.useEffect((()=>(e.current&&e.current.addEventListener("wheel",n,{passive:!1}),()=>{e.current&&e.current.removeEventListener("wheel",n)})),[e,n])}function Y(e,t){if(null==e)return Number.NEGATIVE_INFINITY;const{intervals:n}=e;if(n.length<2)return Number.NEGATIVE_INFINITY;let r,o,s,i,a=0;for(;a<n.length-1;){if([r,o]=n[a],[s,i]=n[a+1],r<=t&&t<=s)return o+(i-o)*(t-r)/(s-r);a+=1}return Number.NEGATIVE_INFINITY}function V(e,t){if(null==e)return Number.NEGATIVE_INFINITY;const n=[...e.intervals].sort(((e,t)=>{let[n,r]=e,[o,s]=t;return r-s}));if(n.length<2)return Number.NEGATIVE_INFINITY;let r,o,s,i,a=0;for(;a<n.length-1;){if([r,o]=n[a],[s,i]=n[a+1],o<=t&&t<=i)return r+(s-r)*(t-o)/(i-o);a+=1}return Number.NEGATIVE_INFINITY}function B(e){return(t,n,r)=>{const o=e(t,r.x),s=e(n,r.y);return i={x:o,y:s,width:e(t,r.x+r.width)-o,height:e(n,r.y+r.height)-s},{x:Math.min(i.x,i.x+i.width),y:Math.min(i.y,i.y+i.height),width:Math.abs(i.width),height:Math.abs(i.height)};var i}}const X=B(Y),G=B(V);function q(e,t){const n=[];if(t<=0)return n;const r=e.intervals.at(0),o=e.intervals.at(-1);if(null==r||null==o)return n;const[s,i]=r[1]<o[1]?[r[1],o[1]]:[o[1],r[1]],a=Math.abs(i-s),c=Math.log10(a/t),u=Math.floor(c),l=c-u<=.69?5*10**u:1*10**(u+1);for(let d=s;d<i;d+=l)n.push([V(e,d),d]);return n}function H(e,t){return e.format(t)}function W(e,t,n,r){return{unit:n??"units",format:r??String,intervals:[[0,e],[1,t]]}}function Z(e,t,n){return{unit:t??"units",format:n??String,intervals:e}}function O(e,t,n,r){return void 0===n&&(n="seconds"),void 0===r&&(r=m.vE),W(e,t,n,r)}function Q(e,t,n,r){return void 0===n&&(n="hertz"),void 0===r&&(r=m.hz),W(e,t,n,r)}function J(e,t,n,r){return void 0===n&&(n="percent"),void 0===r&&(r=m.KN),W(e,t,n,r)}function ee(e){const t=l.useRef(null),n=A(),r=L(t),o=p(),s=I();_(t,o.onWheel);const i=e.tickWidth??80,a=e.tickHeight??20,c=r.x*s.state.zoom.x,u=1*r.y,x=c/i,h=`0 0 ${c/Math.max(1,x)} ${a}`,f=l.useMemo((()=>Array.from(q(n.xaxis,x),(e=>{let[t,r]=e;return(0,d.jsxs)("svg",{className:"axis-tick axis-tick-x",x:String(t),y:1-a/u,width:String(1/x),height:String(a/u),viewBox:h,preserveAspectRatio:"none",children:[(0,d.jsx)("line",{x1:"1",y1:"0",x2:"1",y2:String(a)}),(0,d.jsx)("text",{x:"5",y:"5",children:H(n.xaxis,r)})]},r)}))),[u,Math.floor(x),n.xaxis,h,a]),m=`${`translate(${-s.state.scroll.x}, 0)`} ${`scale(${s.state.zoom.x}, 1)`}`;return(0,d.jsx)("svg",{ref:t,width:"100%",height:"100%",viewBox:"0 0 1 1",preserveAspectRatio:"none",overflow:"visible",children:(0,d.jsx)("g",{transform:m,children:f})})}function te(e){const t=l.useRef(null),n=A(),r=L(t),o=p(),s=I();_(t,o.onWheel);const i=e.tickWidth??80,a=e.tickHeight??20,c=1*r.x,u=r.y*s.state.zoom.y,x=u/a,h=`0 0 ${i} ${u/Math.max(1,x)}`,f=l.useMemo((()=>Array.from(q(n.yaxis,x),(e=>{let[t,r]=e;return(0,d.jsxs)("svg",{className:"axis-tick axis-tick-y",x:String(0),y:String(t),width:String(i/c),height:String(1/x),viewBox:h,preserveAspectRatio:"none",children:[(0,d.jsx)("line",{x1:String(.9*i),y1:"0",x2:String(i),y2:"0"}),(0,d.jsx)("text",{x:"5",y:"0",children:H(n.yaxis,r)})]},r)}))),[Math.floor(x),n.yaxis,h,c,i]),m=`${`translate(0, ${-s.state.scroll.y})`} ${`scale(1, ${s.state.zoom.y})`}`;return(0,d.jsx)("svg",{ref:t,width:"100%",height:"100%",viewBox:"0 0 1 1",preserveAspectRatio:"none",overflow:"visible",children:(0,d.jsx)("g",{transform:m,children:f})})}const ne={},re=l.createContext(ne),oe=re.Provider;function se(){return l.useContext(re)}let ie=function(e){return e.add="add",e.invert="invert",e.replace="replace",e.subtract="subtract",e}({});function ae(e,t,n){switch(n){case ie.invert:return e.symmetricDifference(t);case ie.add:return e.union(t);case ie.subtract:return e.difference(t);case ie.replace:return t}}const ce={canCreate:!0,regions:new Map,selection:new Set,transformedRegions:new Map,transformedSelection:new Set,create(){throw Error("annotate called outside of context")},canDelete:()=>!0,canRead:()=>!0,canUpdate:()=>!0,deleteSelection(){throw Error("delete called outside of context")},deselect(){throw Error("deselect called outside of context")},moveSelection(){throw Error("moveSelection called outside of context")},selectArea(){throw Error("selectArea called outside of context")},selectId(){throw Error("selectId called outside of context")},selectPoint(){throw Error("selectPoint called outside of context")},setRectX(){throw Error("setRectX called outside of context")},setRectX1(){throw Error("setRectX1 called outside of context")},setRectX2(){throw Error("setRectX2 called outside of context")},setRectY(){throw Error("setRectY called outside of context")},setRectY1(){throw Error("setRectY1 called outside of context")},setRectY2(){throw Error("setRectY2 called outside of context")},setRegions(){throw Error("setRegions called outside of context")},setSelection(){throw Error("setSelection called outside of context")},updateRegion(){throw Error("updateRegion called outside of context")},updateRegionProperties(){throw Error("updateRegionProperties called outside of context")},updateSelectedRegions(){throw Error("updateSelectedRegions called outside of context")}},ue=l.createContext(ce);function le(e){const{input:t}=S(),n=se(),r=e.canCreate??ce.canCreate,o=e.canDelete??ce.canDelete,s=e.canRead??ce.canRead,i=e.canUpdate??ce.canUpdate,[a,c]=l.useState(e.initRegions??ce.regions),[u,x]=l.useState(e.initSelection??ce.selection),h=l.useMemo((()=>{const e=new Map;for(const[t,n]of a)s(n)&&e.set(t,n);return e}),[s,a]),f=l.useMemo((()=>new Set(u).intersection(h)),[u,h]),p=l.useCallback(((e,r)=>{x((o=>{const s=new Set;for(const r of a.values()){const o=xe(r,n);e(E(o,t.xaxis?.unit==r.xunit,t.yaxis?.unit==r.yunit))&&s.add(r.id)}return ae(o,s,r??ie.replace)}))}),[n,t,a]),m=l.useCallback(((e,t)=>{const r=n[e.xunit],o=n[e.yunit];if(null==r)throw Error(`axis not found: ${e.xunit}`);if(null==o)throw Error(`axis not found: ${e.yunit}`);return{...e,...X(r,o,t(G(r,o,e)))}}),[n]),y=l.useCallback(((e,t)=>{r&&(c((t=>new Map(t).set(e.id,e))),t?.autoSelect&&x(new Set([e.id])))}),[r]),g=l.useCallback((()=>{c((e=>{const t=new Map;for(const[n,r]of e)u.has(n)&&o(r)||t.set(n,r);return t})),x(new Set)}),[o,u]),v=l.useCallback((()=>{x(new Set)}),[]),w=l.useCallback(((e,n)=>{c((r=>new Map(Array.from(r,(r=>{let[o,s]=r;return u.has(o)&&i(s)?[o,m(s,(r=>({x:M(r.x+(t.xaxis?.unit==s.xunit?e:0),0,1-r.width),y:M(r.y+(t.yaxis?.unit==s.yunit?n:0),0,1-r.height),width:r.width,height:r.height})))]:[o,s]})))))}),[i,t,u,m]),b=l.useCallback(((e,t)=>{p((t=>null!=function(e,t){const n=Math.max(e.x,t.x),r=Math.max(e.y,t.y),o=Math.min(e.x+e.width,t.x+t.width)-n,s=Math.min(e.y+e.height,t.y+t.height)-r;return o<=0||s<=0?null:{x:n,y:r,width:o,height:s}}(t,e)),t)}),[p]),k=l.useCallback(((e,t)=>{x((n=>ae(n,new Set([e]),t??ie.replace)))}),[]),j=l.useCallback(((e,t)=>{p((t=>function(e,t){return t.x>=e.x&&t.x<=e.x+e.width&&t.y>=e.y&&t.y<=e.y+e.height}(t,e)),t)}),[p]),C=l.useCallback(((e,t)=>{i(e)&&c((n=>new Map(n).set(e.id,m(e,(e=>({x:M(e.x+t,0,1-e.width),y:e.y,width:e.width,height:e.height}))))))}),[i,m]),z=l.useCallback((()=>{}),[]),A=l.useCallback(((e,t)=>{i(e)&&c((n=>new Map(n).set(e.id,m(e,(e=>({x:e.x,y:e.y,width:M(e.width+t,.01,1-e.x),height:e.height}))))))}),[i,m]),R=l.useCallback(((e,t)=>{i(e)&&c((n=>new Map(n).set(e.id,m(e,(e=>({x:e.x,y:M(e.y+t,0,1-e.height),width:e.width,height:e.height}))))))}),[i,m]),N=l.useCallback(((e,t)=>{i(e)&&c((n=>new Map(n).set(e.id,m(e,(e=>({x:e.x,y:M(e.y+t,0,e.y+e.height-.01),width:e.width,height:M(e.height-Math.max(t,-e.y),.01,1-e.y)}))))))}),[i,m]),P=l.useCallback(((e,t)=>{i(e)&&c((n=>new Map(n).set(e.id,m(e,(e=>({x:e.x,y:e.y,width:e.width,height:M(e.height+t,.01,1-e.y)}))))))}),[i,m]),T=l.useCallback(((e,t)=>{c((n=>{const r=n.get(e);return r&&i(r)?new Map(n).set(e,"function"==typeof t?t(r):t):n}))}),[i]),$=l.useCallback(((e,t)=>{T(e,(e=>({...e,properties:"function"==typeof t?t(e.properties):t})))}),[T]),D=l.useCallback((e=>{c((t=>{const n=new Map(t);for(const r of f){const o=t.get(r);o&&(i(o)&&n.set(r,"function"==typeof e?e(o):e))}return n}))}),[i,f]);return(0,d.jsx)(ue.Provider,{children:e.children,value:{canCreate:r,regions:a,selection:u,transformedRegions:h,transformedSelection:f,canDelete:o,canRead:s,canUpdate:i,create:y,deleteSelection:g,deselect:v,moveSelection:w,render:e.render,selectArea:b,selectId:k,selectPoint:j,setRectX:C,setRectX1:z,setRectX2:A,setRectY:R,setRectY1:N,setRectY2:P,setRegions:c,setSelection:x,updateRegion:T,updateRegionProperties:$,updateSelectedRegions:D}})}function de(){return l.useContext(ue)}function xe(e,t){const n=t[e.xunit],r=t[e.yunit];if(null==n)throw Error(`axis not found: ${e.xunit}`);if(null==r)throw Error(`axis not found: ${e.yunit}`);return G(n,r,e)}function he(e){switch(!0){case e.ctrlKey||e.metaKey:return ie.invert;case e.shiftKey:return ie.add;case e.altKey:return ie.subtract;default:return ie.replace}}function fe(e){const t=de(),n=l.useMemo((()=>{const n=e.fn(t.regions),r=new Set(t.selection).intersection(n);return{...t,transformedRegions:n,transformedSelection:r}}),[t,e.fn]);return(0,d.jsx)(ue.Provider,{children:e.children,value:n})}function pe(e){const t=de(),n=A(),r=I(),o=e.children??t.render,s=l.useMemo((()=>{const t=E(G(n.xaxis,n.yaxis,e.region),n.xaxis.unit==e.region.xunit,n.yaxis.unit==e.region.yunit);if(Number.isNaN(t.x))return null;if(Number.isNaN(t.y))return null;if(Number.isNaN(t.width))return null;if(Number.isNaN(t.height))return null;const o=`0 0 ${t.width*e.dimensions.x*r.state.zoom.x} ${t.height*e.dimensions.y*r.state.zoom.y}`;return{className:e.selected?"annotation annotation-selected":"annotation",fontSize:"12pt",height:String(t.height),preserveAspectRatio:"none",viewBox:o,width:String(t.width),x:String(t.x),y:String(t.y)}}),[n.xaxis,n.yaxis,e.dimensions,e.region,e.selected,r.state.zoom]);return(0,d.jsx)(d.Fragment,{children:s&&o?.({...e,svgProps:s})})}const me=5*Math.PI/4,ye=-Math.PI/4;let ge=function(e){return e[e.CounterClockwise=-1]="CounterClockwise",e[e.Clockwise=1]="Clockwise",e}({});function ve(e){const t=l.useRef(null),{x:n,y:r}=l.useMemo((()=>{const t=me-e.state*(me-ye);return{x:4*Math.cos(t)/5,y:4*-Math.sin(t)/5}}),[e.state]);return _(t,l.useCallback((t=>{let{dy:n,event:r}=t;e.setState(n*(e.direction??ge.Clockwise)/(r.ctrlKey||r.metaKey?1e3:100))}),[e.setState,e.direction])),(0,d.jsxs)("svg",{ref:t,width:"60",height:"60",viewBox:"-1.1 -1.1 2.2 2.2",children:[(0,d.jsx)("path",{className:"encoder",d:`\n      M ${Math.cos(me)} ${-Math.sin(me)}\n      A 1 1 0 1 1 ${Math.cos(ye)} ${-Math.sin(ye)}\n    `}),(0,d.jsx)("circle",{className:"encoder-marker",cx:n,cy:r,r:"0.10"}),(0,d.jsx)("text",{className:"encoder-text",textAnchor:"middle",x:"0",y:"0.15",children:e.format?.(e.value)??e.value.toFixed(2)}),e.label&&(0,d.jsx)("text",{className:"encoder-text",textAnchor:"middle",x:"0",y:"0.45",children:1==e.label?e.unit:e.label})]})}ve.X=function(e){const t=se(),n=de(),r=xe(e.region,t);return(0,d.jsx)(ve,{direction:e.direction,format:e.format,label:e.label,setState:t=>n.setRectX(e.region,t),state:r.x,unit:e.region.xunit,value:e.region.x})},ve.X2=function(e){const t=de(),n=se(),r=xe(e.region,n);return(0,d.jsx)(ve,{direction:e.direction,format:e.format,label:e.label,setState:n=>t.setRectX2(e.region,n),state:r.width,unit:e.region.xunit,value:e.region.width})},ve.Y1=function(e){const t=de(),n=se(),r=xe(e.region,n);return(0,d.jsx)(ve,{direction:e.direction,format:e.format,label:e.label,setState:n=>t.setRectY1(e.region,n),state:1-r.y,unit:e.region.yunit,value:e.region.y+e.region.height})},ve.Y2=function(e){const t=de(),n=se(),r=xe(e.region,n);return(0,d.jsx)(ve,{direction:e.direction,format:e.format,label:e.label,setState:n=>t.setRectY2(e.region,n),state:1-r.y-r.height,unit:e.region.yunit,value:e.region.y})};const we={onKeyUps:{current:new Set},onKeyDowns:{current:new Set}},be=l.createContext(we);function ke(e){const t=l.useRef(new Set),n=l.useRef(new Set);return l.useEffect((()=>{function e(e){for(const t of n.current)t(e)}function r(e){for(const n of t.current)n(e)}return window.addEventListener("keydown",e),window.addEventListener("keyup",r),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",r)}}),[]),(0,d.jsx)(be.Provider,{value:{onKeyUps:t,onKeyDowns:n},children:e.children})}function Se(e){const{onKeyUps:t,onKeyDowns:n}=l.useContext(be);return l.useEffect((()=>{function r(t){e.onKeyDown&&t.key===e.bind&&e.onKeyDown(t)}function o(t){e.onKeyUp&&t.key===e.bind&&e.onKeyUp(t)}return n.current&&n.current.add(r),t.current&&t.current.add(o),()=>{n.current&&n.current.delete(r),t.current&&t.current.delete(o)}}),[e.onKeyDown,e.onKeyUp,e.bind,t,n]),(0,d.jsx)(d.Fragment,{})}function Me(e){return fetch(e).then((e=>{if(!e.ok)throw Error(`Failed to load audio: ${e.status} ${e.statusText}`);return e.arrayBuffer()})).then((e=>(new AudioContext).decodeAudioData(e)))}const je={audioContext:null,buffer:null,fx:{},state:{pause:!0,seek:0,timecode:0},transport:{play:()=>{throw Error("play called outside of context")},stop:()=>{throw Error("stop called outside of context")},seek:()=>{throw Error("seek called outside of context")},getSeek:()=>{throw Error("getSeek called outside of context")}}},Ce=l.createContext(je);function ze(e){const t=l.useMemo((()=>e.audioContext??new AudioContext),[e.audioContext]),[n,r]=l.useState(je.state),o=l.useMemo((()=>({play:e=>{r((n=>{const r=e??(n.pause?n.seek:t.currentTime-n.timecode);return{pause:!1,seek:r,timecode:t.currentTime-r}}))},seek:n=>{r((r=>{const o=M("function"==typeof n?n(r.pause?r.seek:t.currentTime-r.timecode):n,0,e.buffer.duration),s=t.currentTime-o;return{...r,seek:o,timecode:s}}))},stop:e=>{r((n=>{const r=e??(n.pause?n.seek:t.currentTime-n.timecode);return{pause:!0,seek:r,timecode:t.currentTime-r}}))},getSeek:e=>e.pause?e.seek:t.currentTime-e.timecode})),[t,e.buffer.duration]);return(0,d.jsx)(Ce.Provider,{children:e.children,value:{audioContext:t,buffer:e.buffer,fx:e.fx??je.fx,state:n,transport:o}})}function Ae(){return l.useContext(Ce)}function Re(e){const t=l.useContext(Ce),n=l.useMemo((()=>({...t,fx:e.fn(t.fx)})),[t,e.fn]);return(0,d.jsx)(Ce.Provider,{children:e.children,value:n})}function Ee(e){const t=Ae(),n=l.useRef(null),r=e.format??m.vE;return F(l.useCallback((()=>{n.current&&(n.current.textContent=r(t.transport.getSeek(t.state)))}),[t.transport.getSeek,t.state,r])),(0,d.jsx)("span",{ref:n,children:r(0)})}function Ne(){return Ae().state.pause?(0,d.jsx)(l.Fragment,{}):(0,d.jsx)(Pe,{})}function Pe(){const{audioContext:e,buffer:t,fx:n,state:r,transport:o}=Ae();return l.useEffect((()=>{if(null==e||null==t)return console.warn("Audio.Effect requires an AudioContext and AudioBuffer");let s=null,i=null,a=null;const c=()=>{n.loop?o.play(n.loop[0]):o.stop(0)},u=()=>{s&&(s.disconnect(),s=null),a&&(a.disconnect(),a=null),i&&(i.disconnect(),i=null)};i=e.createBiquadFilter(),i.type="highpass",i.frequency.value=M(n.hpf??0,0,22050),i.Q.value=20,a=e.createBiquadFilter(),a.type="lowpass",a.frequency.value=M(n.lpf??22050,0,22050),a.Q.value=20,s=e.createBufferSource(),s.buffer=t,s.addEventListener("ended",u),s.addEventListener("ended",c),s.connect(a),a.connect(i),i.connect(e.destination);const l=e.currentTime-r.timecode;if(n.loop){const e=Math.max(0,n.loop[1]-l);s.start(0,l,e)}else s.start(0,l);return()=>{s&&(s.removeEventListener("ended",c),s.removeEventListener("ended",u),s.stop()),u()}}),[e,t,r.timecode,o.play,o.stop,n.hpf,n.lpf,n.loop?.[0],n.loop?.[1]]),l.useEffect((()=>{const e=o.getSeek(r);n.loop&&(e<n.loop[0]||e>n.loop[1])&&o.play(n.loop[0])}),[n.loop,n.loop?.[0],n.loop?.[1],r,o.getSeek,o.play]),(0,d.jsx)(l.Fragment,{})}function Te(e){e.setAttribute("display","none")}function $e(e){e.setAttribute("display","inline")}function De(e,t,n,r){switch(void 0===n&&(n=t),void 0===r&&(r=String),e.constructor){case SVGTextElement:e.setAttribute("x",r(t));break;case SVGLineElement:e.setAttribute("x1",r(t)),e.setAttribute("x2",r(n));break;case SVGRectElement:e.setAttribute("x",r(t)),e.setAttribute("width",r(n))}}function Ie(e,t,n,r){switch(void 0===n&&(n=t),void 0===r&&(r=String),e.constructor){case SVGTextElement:e.setAttribute("y",r(t));break;case SVGLineElement:e.setAttribute("y1",r(t)),e.setAttribute("y2",r(n));break;case SVGRectElement:e.setAttribute("y",r(t)),e.setAttribute("height",r(n))}}function Ue(){const e=l.useRef(null),t=Ae();return F(l.useCallback((()=>{if(e.current&&t.buffer){const n=t.transport.getSeek(t.state);De(e.current,n/t.buffer.duration),Ie(e.current,0,1),$e(e.current)}}),[t.buffer,t.state,t.transport.getSeek])),(0,d.jsx)("line",{ref:e,className:"playhead",display:"none",x1:"0",y1:"0",x2:"0",y2:"100%"})}function Fe(e){const t=p(),n=de(),r=l.useRef(null),o=l.useRef(null),s=I(),i=K(t),a=L(r);_(r,t.onWheel);const c=`\n    M 0 0\n    h 1\n    v 1\n    h -1\n    z\n    M ${s.state.scroll.x/s.state.zoom.x} ${s.state.scroll.y/s.state.zoom.y}\n    v ${1/s.state.zoom.y}\n    h ${1/s.state.zoom.x}\n    v ${-1/s.state.zoom.y}\n    z\n  `;return(0,d.jsxs)("svg",{className:"navigator",height:"100%",width:"100%",preserveAspectRatio:"none",viewBox:"0 0 1 1",...i,...e.svgProps,ref:r,children:[(0,d.jsx)("image",{href:e.src,width:"100%",height:"100%",preserveAspectRatio:"none"}),Array.from((e.ignoreRegionTransform?n.regions:n.transformedRegions).values(),(t=>(0,d.jsx)(pe,{children:e.children,dimensions:a,region:t,selected:(e.ignoreRegionTransform?n.selection:n.transformedSelection).has(t.id),viewerId:e.id},t.id))),(0,d.jsx)("path",{ref:o,className:"mask",d:c}),(0,d.jsx)(Ue,{})]})}function Ke(e){const{input:t,mouseup:n,unitUp:r}=S(),o=l.useRef(null),s=l.useRef(null),i=l.useRef(null),a=l.useRef(null),c=A();return F(l.useCallback((()=>{if(o.current&&s.current&&i.current&&a.current&&e.parent.current){const x=o.current;if(t.alt){const o=s.current,h=i.current,f=a.current;let p,y;$e(x),e.parent.current==t.focus||c.xaxis==t.xaxis?(p=H(c.xaxis,r.x),De(o,n.rel.x,void 0,m.KN),$e(o)):(p="",Te(o)),e.parent.current==t.focus||c.yaxis==t.yaxis?(y=H(c.yaxis,r.y),Ie(h,n.rel.y,void 0,m.KN),$e(h)):(y="",Te(h)),function(e,t){e.textContent=t}(f,p&&y?`(${p}, ${y})`:p||y),u=f,l=n.rel,void 0===(d=m.KN)&&(d=String),l.x<.5?(De(u,l.x,void 0,d),u.setAttribute("text-anchor","start")):(De(u,l.x,void 0,d),u.setAttribute("text-anchor","end")),l.y<.5?(Ie(u,l.y+.01,void 0,d),u.setAttribute("dominant-baseline","hanging")):(Ie(u,l.y-.01,void 0,d),u.setAttribute("dominant-baseline","text-top"))}else Te(x)}var u,l,d}),[t,n,c.xaxis,c.yaxis,e.parent,r])),(0,d.jsxs)("g",{ref:o,children:[(0,d.jsx)("line",{ref:s,className:"cursor-x",x1:"0",y1:"0",x2:"0",y2:"100%"}),(0,d.jsx)("line",{ref:i,className:"cursor-y",x1:"0",y1:"0",x2:"100%",y2:"0"}),(0,d.jsx)("text",{ref:a,className:"cursor-text",x:"0",y:"0",children:"0:00"})]})}function Le(e){const t=l.useRef(null),n=de(),r=p(),o=I(),s=L(t),i=K(r);_(t,r.onWheel);const a=`${`translate(${-o.state.scroll.x}, ${-o.state.scroll.y})`} ${`scale(${o.state.zoom.x}, ${o.state.zoom.y})`}`;return(0,d.jsxs)("svg",{className:"visualization",height:"100%",width:"100%",...i,...e.svgProps,ref:t,children:[(0,d.jsx)("defs",{children:(0,d.jsx)("pattern",{id:"dotted-grid",x:"5",y:"5",width:"10",height:"10",patternUnits:"userSpaceOnUse",children:(0,d.jsx)("circle",{cx:"0",cy:"0",r:"1",fill:"black"})})}),(0,d.jsx)("rect",{className:"dotted-grid",width:"100%",height:"100%",fill:"url(#dotted-grid)"}),(0,d.jsx)("svg",{width:"100%",height:"100%",viewBox:"0 0 1 1",preserveAspectRatio:"none",children:(0,d.jsxs)("g",{transform:a,children:[(0,d.jsx)("image",{preserveAspectRatio:"none",href:e.src,width:"100%",height:"100%"}),Array.from((e.ignoreRegionTransform?n.regions:n.transformedRegions).values(),(t=>(0,d.jsx)(pe,{children:e.children,dimensions:s,region:t,selected:(e.ignoreRegionTransform?n.selection:n.transformedSelection).has(t.id),viewerId:e.id},t.id))),e.showSelection&&(0,d.jsx)(_e,{}),(0,d.jsx)(Ue,{})]})}),(0,d.jsx)(Ke,{parent:t})]})}function _e(){const e=l.useRef(null),t=S(),n=A();return F(l.useCallback((()=>{var r,o,s;e.current&&(1&t.input.buttons?($e(e.current),r=e.current,o=E(R(t.mousedown.abs,t.mouseup.abs),n.xaxis===t.input.xaxis,n.yaxis===t.input.yaxis),void 0===s&&(s=String),r.setAttribute("x",s(o.x)),r.setAttribute("y",s(o.y)),r.setAttribute("width",s(o.width)),r.setAttribute("height",s(o.height))):Te(e.current))}),[n.xaxis,n.yaxis,t.input,t.mousedown,t.mouseup])),(0,d.jsx)("rect",{ref:e,className:"selection",x:"0",y:"0",width:"0",height:"0"})}},9359:(e,t,n)=>{n.d(t,{A:()=>a});n(4041);var r=n(213),o=n(1085);function s(e){let{children:t,fallback:n}=e;return(0,r.A)()?(0,o.jsx)(o.Fragment,{children:t?.()}):n??null}var i=n(396);function a(e){const{siteConfig:t}=(0,i.A)();return(0,o.jsx)(s,{children:()=>e.children((e=>t.baseUrl+e),t),fallback:(0,o.jsx)("div",{children:"Loading..."})})}},1184:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>a});var r=n(4041);const o={},s=r.createContext(o);function i(e){const t=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),r.createElement(s.Provider,{value:t},e.children)}}}]);